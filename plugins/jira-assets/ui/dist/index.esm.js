var PluginJiraAssets=function(m,e,l,s){"use strict";/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ze={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(o,a)=>{const c=l.forwardRef(({color:h="currentColor",size:i=24,strokeWidth:T=2,absoluteStrokeWidth:y,className:C="",children:x,...w},r)=>l.createElement("svg",{ref:r,...ze,width:i,height:i,stroke:h,strokeWidth:y?Number(T)*24/Number(i):T,className:["lucide",`lucide-${ve(o)}`,C].join(" "),...w},[...a.map(([D,g])=>l.createElement(D,g)),...Array.isArray(x)?x:[x]]));return c.displayName=`${o}`,c};/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=J("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=J("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=J("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=J("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=J("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=J("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=J("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=J("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=J("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=J("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),d={primary:"#13715B",primaryLight:"#5FA896",primaryRing:"#13715B1A",border:{dark:"#D0D5DD",light:"#E5E7EB"},text:{primary:"#344054",secondary:"#475467",tertiary:"#667085"},background:{main:"#FFFFFF",fill:"#F9FAFB",accent:"#F3F4F6"},error:{main:"#D92D20",border:"#FDA29B"}},Pe=(o=!1)=>({"& fieldset":{borderColor:o?d.error.border:d.border.dark,borderRadius:"4px",transition:"border-color 150ms ease-in-out, box-shadow 150ms ease-in-out"},"&:not(:has(.Mui-disabled)):not(:has(.Mui-focused)) .MuiOutlinedInput-root:hover fieldset":{borderColor:o?d.error.border:d.primaryLight},"& .MuiOutlinedInput-root.Mui-focused fieldset":{borderColor:o?d.error.border:`${d.primary} !important`,borderWidth:"2px",...o?{}:{boxShadow:`0 0 0 3px ${d.primaryRing}`}},"& .MuiOutlinedInput-root.Mui-disabled":{backgroundColor:d.background.fill,cursor:"not-allowed","& fieldset":{borderColor:d.border.light}}}),Ne=(o=!1)=>({"& .MuiOutlinedInput-notchedOutline":{borderColor:o?d.error.border:d.border.dark,borderRadius:"4px",transition:"border-color 150ms ease-in-out, box-shadow 150ms ease-in-out"},"&:not(.Mui-disabled):hover .MuiOutlinedInput-notchedOutline":{borderColor:o?d.error.border:d.primaryLight},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:o?d.error.border:`${d.primary} !important`,borderWidth:"2px",...o?{}:{boxShadow:`0 0 0 3px ${d.primaryRing}`}},"&.Mui-disabled":{backgroundColor:d.background.fill,cursor:"not-allowed","& .MuiOutlinedInput-notchedOutline":{borderColor:d.border.light}}}),te=l.forwardRef(({type:o="text",id:a,label:c,isRequired:h,isOptional:i,optionalLabel:T,placeholder:y,value:C,onChange:x,onBlur:w,error:r,disabled:D,width:g,sx:b,rows:f,helperText:A,InputProps:I},U)=>{const[E,H]=l.useState(!1);return e.jsxs(s.Stack,{gap:1,sx:{...Pe(!!r),width:g,...b||{}},children:[c&&e.jsxs(s.Typography,{component:"p",color:d.text.secondary,fontWeight:500,fontSize:"13px",sx:{margin:0,height:"22px"},children:[c,h&&e.jsx(s.Typography,{component:"span",ml:.5,color:d.error.main,children:"*"}),i&&e.jsx(s.Typography,{component:"span",fontSize:"inherit",fontWeight:400,ml:1,sx:{opacity:.6},children:T||"(optional)"})]}),e.jsx(s.TextField,{type:o==="password"&&E?"text":o,id:a,placeholder:y,multiline:o==="description"||f&&f>1,rows:o==="description"?f||4:f||1,value:C,onChange:x,onBlur:w,disabled:D,inputRef:U,helperText:A,size:"small",fullWidth:!0,inputProps:{sx:{color:d.text.secondary,fontSize:13,padding:"8px 12px"}},InputProps:{...I,endAdornment:(I==null?void 0:I.endAdornment)||o==="password"&&e.jsx(s.InputAdornment,{position:"end",children:e.jsx(s.IconButton,{"aria-label":"toggle password visibility",onClick:()=>H(Z=>!Z),tabIndex:-1,sx:{color:d.border.dark,padding:.5,"&:focus":{outline:"none"}},children:E?e.jsx(Se,{size:16}):e.jsx($e,{size:16})})})},sx:{fontSize:13}}),r&&e.jsx(s.Typography,{component:"span",color:d.error.main,mt:.5,sx:{opacity:.8,fontSize:11},children:r})]})});te.displayName="VWField";const le=({id:o,label:a,placeholder:c,value:h,items:i,onChange:T,isRequired:y,error:C,disabled:x,width:w,sx:r})=>{const D=g=>{const b=g,f=i.find(A=>A._id===b);return e.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:f?d.text.primary:d.text.tertiary},children:f?`${f.name}${f.surname?" "+f.surname:""}`:c||"Select..."})};return e.jsxs(s.Stack,{gap:1,sx:{width:w},children:[a&&e.jsxs(s.Typography,{component:"p",color:d.text.secondary,fontWeight:500,fontSize:"13px",sx:{margin:0,height:"22px",display:"flex",alignItems:"center"},children:[a,y&&e.jsx(s.Typography,{component:"span",ml:.5,color:d.error.main,children:"*"})]}),e.jsx(s.Select,{value:h,onChange:T,displayEmpty:!0,inputProps:{id:o},renderValue:D,size:"small",IconComponent:()=>e.jsx(Je,{size:16,style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:d.text.tertiary}}),disabled:x,MenuProps:{disableScrollLock:!0,PaperProps:{sx:{borderRadius:"4px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",mt:1,"& .MuiMenuItem-root":{fontSize:13,color:d.text.primary,transition:"color 0.2s ease, background-color 0.2s ease","&:hover":{backgroundColor:d.background.accent,color:d.primary},"&.Mui-selected":{backgroundColor:d.background.accent,"&:hover":{backgroundColor:d.background.accent,color:d.primary}}}}}},sx:{fontSize:13,minWidth:"125px",width:"100%",backgroundColor:d.background.main,...Ne(!!C),...r},children:i.map(g=>e.jsx(s.MenuItem,{value:g._id,sx:{fontSize:13,color:d.text.tertiary,borderRadius:"4px",margin:"4px 8px"},children:`${g.name}${g.surname?" "+g.surname:""}`},`${o}-${g._id}`))}),C&&e.jsx(s.Typography,{color:d.error.main,mt:.5,sx:{opacity:.8,fontSize:11},children:C})]})},Ue=({checked:o,onChange:a,disabled:c,label:h,description:i})=>{const T={width:36,height:22,padding:"2px 0",marginRight:1,display:"flex",alignItems:"center","& .MuiSwitch-switchBase":{padding:"2px","&.Mui-checked":{transform:"translateX(14px)",color:"#fff","& + .MuiSwitch-track":{backgroundColor:d.primary,opacity:1,border:0}}},"& .MuiSwitch-thumb":{boxShadow:"0 2px 4px 0 rgb(0 35 11 / 20%)",width:14,height:14,borderRadius:"4px !important",backgroundColor:"#fff",margin:0},"& .MuiSwitch-track":{borderRadius:"4px !important",backgroundColor:d.border.light,opacity:1,transition:"background-color 200ms"}};return h||i?e.jsxs(s.Stack,{direction:"row",alignItems:"flex-start",gap:1.5,children:[e.jsx(s.Switch,{checked:o,onChange:a,disabled:c,disableRipple:!0,sx:T}),e.jsxs(s.Stack,{children:[h&&e.jsx(s.Typography,{fontSize:13,fontWeight:500,color:d.text.primary,children:h}),i&&e.jsx(s.Typography,{fontSize:12,color:d.text.tertiary,children:i})]})]}):e.jsx(s.Switch,{checked:o,onChange:a,disabled:c,disableRipple:!0,sx:T})},He=({configData:o={},onConfigChange:a,onSaveConfiguration:c,onTestConnection:h,isSavingConfig:i=!1,isTestingConnection:T=!1,apiServices:y,pluginApiCall:C})=>{const x=l.useCallback(async(t,p,v)=>{var he;if(C)return C(t,p,v);if(!y)throw new Error("No API service available");const B=`/plugins/jira-assets${p.startsWith("/")?p:`/${p}`}`;let K;switch(t.toUpperCase()){case"GET":K=await y.get(B);break;case"POST":K=await y.post(B,v);break;case"PUT":K=await y.put(B,v);break;case"PATCH":K=await y.patch(B,v);break;case"DELETE":K=await y.delete(B);break;default:throw new Error(`Unsupported method: ${t}`)}return((he=K.data)==null?void 0:he.data)??K.data},[y,C]),w=!!(y||C),[r,D]=l.useState({deployment_type:"cloud",sync_enabled:!1,sync_interval_hours:24,...o}),[g,b]=l.useState(!1),[f,A]=l.useState([]),[I,U]=l.useState([]),[E,H]=l.useState(!1),[Z,X]=l.useState(!1),[S,F]=l.useState("idle"),[k,$]=l.useState(""),[ee,q]=l.useState(!1),[M,O]=l.useState(null),[_,j]=l.useState([]),[V,se]=l.useState(new Set),[ce,ae]=l.useState(!1),[Q,de]=l.useState(!1),[oe,W]=l.useState(null),[Y,n]=l.useState([]),[u,z]=l.useState(!1),[P,L]=l.useState(!1),[N,ne]=l.useState(null);l.useEffect(()=>{if(g||!y)return;(async()=>{var p;try{const B=await y.get("/plugins/jira-assets/config"),K=((p=B.data)==null?void 0:p.data)??B.data;K&&D(he=>({...he,...K}))}catch(v){console.error("Failed to load JIRA config:",v)}finally{b(!0)}})()},[y,g]);const G=l.useCallback((t,p)=>{D(v=>({...v,[t]:p})),a&&a(t,p)},[a]),Ae=l.useCallback(async()=>{if(!(!w||!r.jira_base_url||!r.workspace_id)){H(!0);try{const t=await x("GET","/schemas");t&&Array.isArray(t)&&A(t)}catch(t){console.error("Failed to load schemas:",t)}finally{H(!1)}}},[w,x,r.jira_base_url,r.workspace_id]),be=l.useCallback(async t=>{if(!(!w||!t)){X(!0);try{const p=await x("GET",`/schemas/${t}/object-types`);console.log("[JiraConfig] loadObjectTypes response:",p,"isArray:",Array.isArray(p)),p&&Array.isArray(p)?U(p):console.warn("[JiraConfig] Object types response is not an array:",typeof p)}catch(p){console.error("Failed to load object types:",p)}finally{X(!1)}}},[w,x]),Ie=l.useCallback(async()=>{if(!(!w||!r.selected_object_type_id)){ae(!0),W(null);try{const t=await x("GET",`/object-types/${r.selected_object_type_id}/objects`);if(t&&Array.isArray(t)){const p=new Set(Y.map(B=>B.jira_object_id)),v=t.filter(B=>!p.has(B.id));j(v)}}catch(t){W({type:"error",text:t.message||"Failed to load JIRA objects"})}finally{ae(!1)}}},[w,x,r.selected_object_type_id,Y]),ie=l.useCallback(async()=>{if(w){z(!0);try{const t=await x("GET","/use-cases");t&&Array.isArray(t)&&n(t)}catch(t){console.error("Failed to load imported use cases:",t)}finally{z(!1)}}},[w,x]),ts=async()=>{if(!(!w||V.size===0)){de(!0),W(null);try{const t=await x("POST","/import",{object_ids:Array.from(V)});t!=null&&t.success?(W({type:"success",text:`Successfully imported ${t.imported} objects`}),se(new Set),await ie(),await Ie()):W({type:"error",text:(t==null?void 0:t.error)||"Import failed"})}catch(t){W({type:"error",text:t.message||"Import failed"})}finally{de(!1)}}},rs=async()=>{if(w){L(!0),ne(null);try{const t=await x("POST","/sync");t!=null&&t.success?(ne({type:"success",text:`Sync completed: ${t.objectsCreated||0} created, ${t.objectsUpdated||0} updated, ${t.objectsDeleted||0} deleted`}),await ie(),D(p=>({...p,last_sync_at:new Date().toISOString(),last_sync_status:"success"}))):ne({type:"error",text:(t==null?void 0:t.error)||"Sync failed"})}catch(t){ne({type:"error",text:t.message||"Sync failed"})}finally{L(!1)}}},ns=t=>{se(p=>{const v=new Set(p);return v.has(t)?v.delete(t):v.add(t),v})},ls=()=>{V.size===_.length?se(new Set):se(new Set(_.map(t=>t.id)))},cs=async()=>{if(!w){h&&h();return}F("testing"),$("");try{const t=await x("POST","/test-connection",{configuration:{jira_base_url:r.jira_base_url,workspace_id:r.workspace_id,email:r.email,api_token:r.api_token,deployment_type:r.deployment_type||"cloud"}});t!=null&&t.success?(F("success"),$(t.message||"Connection successful. Click 'Save Configuration' to proceed to Step 2.")):(F("error"),$((t==null?void 0:t.message)||"Connection failed"))}catch(t){F("error"),$(t.message||"Connection test failed")}},as=async()=>{var t,p;if(y){q(!0),O(null);try{const v=await y.post("/plugins/jira-assets/config",{jira_base_url:r.jira_base_url,workspace_id:r.workspace_id,email:r.email,api_token:r.api_token||void 0,deployment_type:r.deployment_type||"cloud",selected_schema_id:r.selected_schema_id||void 0,selected_object_type_id:r.selected_object_type_id||void 0,sync_enabled:r.sync_enabled||!1,sync_interval_hours:r.sync_interval_hours||24}),B=((t=v.data)==null?void 0:t.data)??v.data;B!=null&&B.success?(O({type:"success",text:"Configuration saved successfully!"}),D(K=>({...K,has_api_token:!0})),b(!1)):O({type:"error",text:((p=B==null?void 0:B.errors)==null?void 0:p.join(", "))||(B==null?void 0:B.message)||"Failed to save configuration"})}catch(v){O({type:"error",text:v.message||"Failed to save configuration"})}finally{q(!1)}}},ds=t=>{G("selected_schema_id",t),G("selected_object_type_id",""),U([]),t&&be(t)};l.useEffect(()=>{console.log("[JiraConfig] Schema load check:",{has_api_token:r.has_api_token,jira_base_url:r.jira_base_url,workspace_id:r.workspace_id,schemas_length:f.length}),r.has_api_token&&r.jira_base_url&&r.workspace_id&&f.length===0&&(console.log("[JiraConfig] Calling loadSchemas()"),Ae())},[r.has_api_token,r.jira_base_url,r.workspace_id,Ae,f.length]),l.useEffect(()=>{r.has_api_token&&r.selected_schema_id&&I.length===0&&be(r.selected_schema_id)},[r.has_api_token,r.selected_schema_id,be,I.length]),l.useEffect(()=>{w&&g&&ie()},[w,g,ie]);const is=[{value:1,label:"Every hour"},{value:6,label:"Every 6 hours"},{value:12,label:"Every 12 hours"},{value:24,label:"Every 24 hours"},{value:48,label:"Every 48 hours"}];return e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"body2",color:"text.secondary",fontSize:13,sx:{mb:3},children:"Connect to your Jira Service Management Assets to import AI Systems as use-cases."}),e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{mb:2,color:"#344054"},children:"Step 1: Connection Settings"}),e.jsxs(s.Stack,{spacing:2.5,children:[e.jsxs(s.Box,{children:[e.jsx(le,{id:"deployment_type",label:"Deployment Type",isRequired:!0,value:r.deployment_type||"cloud",onChange:t=>G("deployment_type",t.target.value),items:[{_id:"cloud",name:"JIRA Cloud (Atlassian-hosted)"},{_id:"datacenter",name:"JIRA Data Center / Server (Self-hosted)"}]}),e.jsx(s.Typography,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:"Select Cloud for *.atlassian.net, or Data Center for self-hosted JIRA"})]}),e.jsx(s.Box,{children:e.jsx(te,{id:"jira_base_url",label:"JIRA Base URL",isRequired:!0,placeholder:r.deployment_type==="datacenter"?"https://jira.your-company.com":"https://your-company.atlassian.net",value:r.jira_base_url||"",onChange:t=>G("jira_base_url",t.target.value)})}),e.jsxs(s.Box,{children:[e.jsx(te,{id:"workspace_id",label:r.deployment_type==="datacenter"?"Insight Object Schema ID":"Workspace ID",isRequired:!0,placeholder:r.deployment_type==="datacenter"?"Enter object schema ID (e.g., 1)":"Enter your JSM Assets workspace ID",value:r.workspace_id||"",onChange:t=>G("workspace_id",t.target.value)}),e.jsx(s.Typography,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:r.deployment_type==="datacenter"?"For Data Center: Use object schema ID from Insight settings":"Found in Assets settings or the URL when viewing Assets"})]}),e.jsx(s.Box,{children:e.jsx(te,{id:"email",label:r.deployment_type==="datacenter"?"Username":"Email",isRequired:!0,type:r.deployment_type==="datacenter"?"text":"email",placeholder:r.deployment_type==="datacenter"?"your-username":"your-email@company.com",value:r.email||"",onChange:t=>G("email",t.target.value)})}),e.jsxs(s.Box,{children:[e.jsx(te,{id:"api_token",label:r.deployment_type==="datacenter"?"Password / Token":"API Token",isRequired:!r.has_api_token,type:"password",placeholder:r.has_api_token&&!r.api_token?"••••••••••••••••  (saved - enter new value to change)":r.deployment_type==="datacenter"?"Enter your password or personal access token":"Enter your Atlassian API token",value:r.api_token||"",onChange:t=>G("api_token",t.target.value)}),e.jsx(s.Typography,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:r.has_api_token&&!r.api_token?"API token is saved. Leave empty to keep current token, or enter a new value to update.":r.deployment_type==="datacenter"?"Use your JIRA password or personal access token":"Generate at id.atlassian.com/manage-profile/security/api-tokens"})]})]}),S!=="idle"&&e.jsx(s.Box,{sx:{mt:2},children:e.jsx(s.Alert,{severity:S==="success"?"success":S==="error"?"error":"info",sx:{fontSize:"13px"},children:S==="testing"?"Testing connection...":k})}),M&&e.jsx(s.Box,{sx:{mt:2},children:e.jsx(s.Alert,{severity:M.type,sx:{fontSize:"13px"},onClose:()=>O(null),children:M.text})}),e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2},children:[e.jsx(s.Button,{variant:"outlined",onClick:cs,disabled:T||S==="testing"||!r.jira_base_url||!r.workspace_id||!r.email||!r.api_token&&!r.has_api_token,sx:{borderColor:"#13715B",color:"#13715B",textTransform:"none",fontSize:"13px",fontWeight:500,"&:hover":{borderColor:"#0f5a47",backgroundColor:"rgba(19, 113, 91, 0.04)"},"&:disabled":{borderColor:"#d0d5dd",color:"#98a2b3"}},children:T||S==="testing"?e.jsxs(e.Fragment,{children:[e.jsx(s.CircularProgress,{size:16,sx:{mr:1}}),"Testing..."]}):"Test Connection"}),e.jsx(s.Button,{variant:"contained",onClick:as,disabled:ee||!r.jira_base_url||!r.workspace_id||!r.email||!r.api_token&&!r.has_api_token,sx:{backgroundColor:"#13715B",textTransform:"none",fontSize:"13px",fontWeight:500,"&:hover":{backgroundColor:"#0f5a47"},"&:disabled":{backgroundColor:"#d0d5dd"}},children:ee?e.jsxs(e.Fragment,{children:[e.jsx(s.CircularProgress,{size:16,sx:{mr:1,color:"white"}}),"Saving..."]}):"Save Configuration"})]}),e.jsx(s.Divider,{sx:{my:3}}),e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{mb:2,color:"#344054"},children:"Step 2: Select Schema & Object Type"}),e.jsxs(s.Stack,{spacing:2.5,children:[e.jsx(s.Box,{children:e.jsx(le,{id:"selected_schema_id",label:"Schema",placeholder:E?"Loading schemas...":"Select a schema",value:r.selected_schema_id||"",onChange:t=>ds(t.target.value),disabled:E||f.length===0,items:f.map(t=>({_id:t.id,name:`${t.name} (${t.objectSchemaKey})`}))})}),e.jsx(s.Box,{children:e.jsx(le,{id:"selected_object_type_id",label:"Object Type (AI Systems)",placeholder:Z?"Loading object types...":"Select an object type",value:r.selected_object_type_id||"",onChange:t=>G("selected_object_type_id",t.target.value),disabled:Z||I.length===0||!r.selected_schema_id,items:I.map(t=>({_id:t.id,name:t.objectCount!==void 0?`${t.name} (${t.objectCount} objects)`:t.name}))})})]}),e.jsx(s.Divider,{sx:{my:3}}),e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{mb:2,color:"#344054"},children:"Step 3: Sync Settings"}),e.jsxs(s.Stack,{spacing:2.5,children:[e.jsx(s.Box,{children:e.jsx(Ue,{checked:r.sync_enabled||!1,onChange:t=>G("sync_enabled",t.target.checked),label:"Enable automatic sync",description:"Automatically sync data from JIRA on a schedule"})}),r.sync_enabled&&e.jsx(s.Box,{children:e.jsx(le,{id:"sync_interval_hours",label:"Sync Interval",value:r.sync_interval_hours||24,onChange:t=>G("sync_interval_hours",t.target.value),items:is.map(t=>({_id:t.value,name:t.label}))})})]}),r.last_sync_at&&e.jsx(s.Box,{sx:{mt:2},children:e.jsxs(s.Alert,{severity:r.last_sync_status==="success"?"success":"warning",sx:{fontSize:"13px"},children:["Last sync: ",new Date(r.last_sync_at).toLocaleString()," -"," ",r.last_sync_status==="success"?"Successful":r.last_sync_message]})}),r.has_api_token&&r.selected_object_type_id&&e.jsxs(e.Fragment,{children:[e.jsx(s.Divider,{sx:{my:3}}),e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{color:"#344054"},children:"Import & Sync"}),e.jsxs(s.Typography,{variant:"body2",fontSize:12,color:"text.secondary",children:[Y.length," use cases imported",r.last_sync_at&&` • Last sync: ${new Date(r.last_sync_at).toLocaleString()}`]})]}),e.jsxs(s.Box,{sx:{display:"flex",gap:1},children:[e.jsx(s.Button,{variant:"outlined",startIcon:P?e.jsx(s.CircularProgress,{size:14}):e.jsx(ye,{size:14}),onClick:rs,disabled:P||Y.length===0,sx:{borderColor:"#13715B",color:"#13715B",textTransform:"none",fontSize:"13px","&:hover":{borderColor:"#0f5a47",backgroundColor:"rgba(19, 113, 91, 0.04)"},"&:disabled":{borderColor:"#d0d5dd",color:"#98a2b3"}},children:P?"Syncing...":"Sync Now"}),e.jsx(s.Button,{variant:"contained",startIcon:Q?e.jsx(s.CircularProgress,{size:14,sx:{color:"white"}}):e.jsx(pe,{size:14}),onClick:Ie,disabled:Q||ce,sx:{backgroundColor:"#13715B",textTransform:"none",fontSize:"13px","&:hover":{backgroundColor:"#0f5a47"},"&:disabled":{backgroundColor:"#d0d5dd"}},children:ce?"Loading...":"Import"})]})]}),oe&&e.jsx(s.Alert,{severity:oe.type,sx:{mt:2,fontSize:"13px"},onClose:()=>W(null),children:oe.text}),N&&e.jsx(s.Alert,{severity:N.type,sx:{mt:2,fontSize:"13px"},onClose:()=>ne(null),children:N.text}),_.length>0&&e.jsxs(s.Box,{sx:{mt:2},children:[e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsx(s.FormControlLabel,{control:e.jsx(s.Checkbox,{checked:V.size===_.length&&_.length>0,indeterminate:V.size>0&&V.size<_.length,onChange:ls,size:"small"}),label:e.jsxs(s.Typography,{variant:"body2",fontSize:13,children:["Select All (",_.length," available)"]})}),e.jsx(s.Button,{variant:"contained",onClick:ts,disabled:Q||V.size===0,startIcon:Q?e.jsx(s.CircularProgress,{size:14,sx:{color:"white"}}):e.jsx(pe,{size:14}),sx:{backgroundColor:"#13715B",textTransform:"none",fontSize:"13px","&:hover":{backgroundColor:"#0f5a47"}},children:Q?"Importing...":`Import ${V.size} Selected`})]}),e.jsx(s.TableContainer,{component:s.Paper,sx:{maxHeight:250,boxShadow:"none",border:"1px solid #e4e7ec"},children:e.jsxs(s.Table,{size:"small",stickyHeader:!0,children:[e.jsx(s.TableHead,{children:e.jsxs(s.TableRow,{sx:{backgroundColor:"#f9fafb"},children:[e.jsx(s.TableCell,{padding:"checkbox"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Key"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Name"})]})}),e.jsx(s.TableBody,{children:_.map(t=>e.jsxs(s.TableRow,{hover:!0,selected:V.has(t.id),onClick:()=>ns(t.id),sx:{cursor:"pointer"},children:[e.jsx(s.TableCell,{padding:"checkbox",children:e.jsx(s.Checkbox,{checked:V.has(t.id),size:"small"})}),e.jsx(s.TableCell,{sx:{fontSize:"13px",fontFamily:"monospace"},children:t.key}),e.jsx(s.TableCell,{sx:{fontSize:"13px"},children:t.name})]},t.id))})]})})]}),Y.length>0&&e.jsxs(s.Box,{sx:{mt:3},children:[e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{mb:1.5,color:"#344054"},children:"Imported Use Cases"}),e.jsx(s.TableContainer,{component:s.Paper,sx:{maxHeight:300,boxShadow:"none",border:"1px solid #e4e7ec"},children:e.jsxs(s.Table,{size:"small",stickyHeader:!0,children:[e.jsx(s.TableHead,{children:e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px",backgroundColor:"#f9fafb"},children:"UC-ID"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px",backgroundColor:"#f9fafb"},children:"Name"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px",backgroundColor:"#f9fafb"},children:"JIRA Key"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px",backgroundColor:"#f9fafb"},children:"Status"})]})}),e.jsx(s.TableBody,{children:Y.map(t=>{const p=typeof t.data=="string"?JSON.parse(t.data):t.data,v=(p==null?void 0:p.objectKey)||"-";return e.jsxs(s.TableRow,{hover:!0,children:[e.jsx(s.TableCell,{sx:{fontSize:"13px",fontFamily:"monospace"},children:t.uc_id}),e.jsx(s.TableCell,{sx:{fontSize:"13px"},children:t.name||(p==null?void 0:p.label)||"-"}),e.jsx(s.TableCell,{sx:{fontSize:"13px",fontFamily:"monospace"},children:v}),e.jsx(s.TableCell,{children:e.jsx(s.Chip,{label:t.sync_status,size:"small",color:t.sync_status==="synced"?"success":t.sync_status==="updated"?"info":"default",sx:{fontSize:"11px"}})})]},t.id)})})]})})]})]})]})},Ve=({apiServices:o,pluginApiCall:a})=>{const c=l.useCallback(async(n,u,z)=>{var N;if(a)return a(n,u,z);if(!o)throw new Error("No API service available");const P=`/plugins/jira-assets${u.startsWith("/")?u:`/${u}`}`;let L;switch(n.toUpperCase()){case"GET":L=await o.get(P);break;case"POST":L=await o.post(P,z);break;case"PUT":L=await o.put(P,z);break;case"PATCH":L=await o.patch(P,z);break;case"DELETE":L=await o.delete(P);break;default:throw new Error(`Unsupported method: ${n}`)}return((N=L.data)==null?void 0:N.data)??L.data},[o,a]),h=!!(o||a),[i,T]=l.useState([]),[y,C]=l.useState(!0),[x,w]=l.useState(!1),[r,D]=l.useState(null),[g,b]=l.useState(null),[f,A]=l.useState(!1),[I,U]=l.useState([]),[E,H]=l.useState(new Set),[Z,X]=l.useState(!1),[S,F]=l.useState(!1),[k,$]=l.useState(null),[ee,q]=l.useState(!1),M=l.useCallback(async()=>{if(h){C(!0),b(null);try{const n=await c("GET","/use-cases");Array.isArray(n)&&T(n)}catch(n){b(n.message||"Failed to load use cases")}finally{C(!1)}}},[h,c]),O=l.useCallback(async()=>{if(h)try{const n=await c("GET","/sync/status");D(n)}catch(n){console.error("Failed to load sync status:",n)}},[h,c]);l.useEffect(()=>{M(),O()},[M,O]);const _=async()=>{if(h){w(!0),b(null);try{const n=await c("POST","/sync");n!=null&&n.success?(await M(),await O()):b((n==null?void 0:n.status)||"Sync failed")}catch(n){b(n.message||"Sync failed")}finally{w(!1)}}},j=async()=>{if(h){A(!0),X(!0),H(new Set),U([]);try{const n=await c("GET","/config"),u=n==null?void 0:n.selected_object_type_id;if(!u){b("No object type configured. Please configure the plugin first."),X(!1);return}const z=await c("GET",`/object-types/${u}/objects`);if(Array.isArray(z)){const P=new Set(i.map(N=>N.jira_object_id)),L=z.filter(N=>!P.has(N.id));U(L)}}catch(n){b(n.message||"Failed to load JIRA objects")}finally{X(!1)}}},V=n=>{H(u=>{const z=new Set(u);return z.has(n)?z.delete(n):z.add(n),z})},se=()=>{E.size===I.length?H(new Set):H(new Set(I.map(n=>n.id)))},ce=async()=>{if(!(!c||E.size===0)){F(!0),b(null);try{const n=await c("POST","/import",{object_ids:Array.from(E)});n!=null&&n.success?(A(!1),await M()):b((n==null?void 0:n.error)||"Import failed")}catch(n){b(n.message||"Import failed")}finally{F(!1)}}},ae=n=>{$(n),q(!0)},Q=n=>{window.location.href=`/project-view?projectId=jira-assets-${n.project_id}`},de=n=>{var z;const u=typeof n.data=="string"?JSON.parse(n.data):n.data;return(u==null?void 0:u.label)||((z=u==null?void 0:u.attributes)==null?void 0:z.Name)||n.uc_id},oe=async n=>{if(h&&window.confirm(`Are you sure you want to delete "${de(n)}"?`))try{await c("DELETE",`/use-cases/${n.id}`),await M(),(k==null?void 0:k.id)===n.id&&(q(!1),$(null))}catch(u){b(u.message||"Failed to delete use case")}},W=n=>n?new Date(n).toLocaleString():"N/A",Y=n=>{switch(n){case"synced":return e.jsx(s.Chip,{label:"Synced",size:"small",color:"success",sx:{fontSize:"11px"}});case"updated":return e.jsx(s.Chip,{label:"Updated",size:"small",color:"info",sx:{fontSize:"11px"}});case"deleted_in_jira":return e.jsx(s.Chip,{label:"Deleted in JIRA",size:"small",color:"error",sx:{fontSize:"11px"}});default:return e.jsx(s.Chip,{label:n,size:"small",sx:{fontSize:"11px"}})}};return e.jsxs(s.Box,{sx:{p:3},children:[e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"h6",fontWeight:600,children:"JIRA AI Systems"}),e.jsx(s.Typography,{variant:"body2",color:"text.secondary",fontSize:13,children:"AI Systems imported from Jira Service Management Assets"})]}),e.jsxs(s.Box,{sx:{display:"flex",gap:2},children:[e.jsx(s.Button,{variant:"outlined",startIcon:x?e.jsx(s.CircularProgress,{size:16}):e.jsx(ye,{size:16}),onClick:_,disabled:x,sx:{borderColor:"#d0d5dd",color:"#344054",textTransform:"none",fontSize:"13px"},children:x?"Syncing...":"Sync Now"}),e.jsx(s.Button,{variant:"contained",startIcon:e.jsx(pe,{size:16}),onClick:j,sx:{backgroundColor:"#13715B",textTransform:"none",fontSize:"13px","&:hover":{backgroundColor:"#0f5a47"}},children:"Import from JIRA"})]})]}),r&&e.jsx(s.Alert,{severity:r.last_sync_status==="success"?"success":r.last_sync_status==="failed"?"warning":"info",sx:{mb:2,fontSize:"13px"},icon:e.jsx(ue,{size:18}),children:e.jsxs(s.Box,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{children:["Last sync: ",r.last_sync_at?W(r.last_sync_at):"Never"]}),r.sync_enabled&&e.jsx(s.Chip,{label:`Auto-sync: Every ${r.sync_interval_hours}h`,size:"small",color:"primary",variant:"outlined",sx:{fontSize:"11px"}})]})}),g&&e.jsx(s.Alert,{severity:"error",sx:{mb:2,fontSize:"13px"},onClose:()=>b(null),children:g}),y?e.jsx(s.Box,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(s.CircularProgress,{})}):i.length===0?e.jsxs(s.Paper,{sx:{p:4,textAlign:"center"},children:[e.jsx(Fe,{size:48,color:"#98a2b3"}),e.jsx(s.Typography,{variant:"h6",sx:{mt:2,color:"#344054"},children:"No JIRA AI Systems Imported"}),e.jsx(s.Typography,{variant:"body2",color:"text.secondary",sx:{mt:1},children:'Click "Import from JIRA" to start importing AI Systems from your JSM Assets.'})]}):e.jsx(s.TableContainer,{component:s.Paper,sx:{boxShadow:"none",border:"1px solid #e4e7ec"},children:e.jsxs(s.Table,{size:"small",children:[e.jsx(s.TableHead,{children:e.jsxs(s.TableRow,{sx:{backgroundColor:"#f9fafb"},children:[e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"UC-ID"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Name"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"JIRA Key"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Sync Status"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Last Synced"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},align:"right",children:"Actions"})]})}),e.jsx(s.TableBody,{children:i.map(n=>{var z;const u=typeof n.data=="string"?JSON.parse(n.data):n.data;return e.jsxs(s.TableRow,{hover:!0,children:[e.jsx(s.TableCell,{sx:{fontSize:"13px",fontFamily:"monospace"},children:n.uc_id}),e.jsx(s.TableCell,{sx:{fontSize:"13px",cursor:"pointer",color:"#13715B","&:hover":{textDecoration:"underline"}},onClick:()=>Q(n),children:(u==null?void 0:u.label)||((z=u==null?void 0:u.attributes)==null?void 0:z.Name)||"-"}),e.jsx(s.TableCell,{sx:{fontSize:"13px",fontFamily:"monospace"},children:(u==null?void 0:u.objectKey)||"-"}),e.jsx(s.TableCell,{children:Y(n.sync_status)}),e.jsx(s.TableCell,{sx:{fontSize:"12px",color:"#667085"},children:W(n.last_synced_at)}),e.jsxs(s.TableCell,{align:"right",children:[e.jsx(s.Tooltip,{title:"Open Use Case",children:e.jsx(s.IconButton,{size:"small",onClick:()=>Q(n),color:"primary",children:e.jsx(De,{size:16})})}),e.jsx(s.Tooltip,{title:"View JIRA Data",children:e.jsx(s.IconButton,{size:"small",onClick:()=>ae(n),children:e.jsx(Se,{size:16})})}),e.jsx(s.Tooltip,{title:"Delete",children:e.jsx(s.IconButton,{size:"small",onClick:()=>oe(n),color:"error",children:e.jsx(Ce,{size:16})})})]})]},n.id)})})]})}),e.jsxs(s.Dialog,{open:f,onClose:()=>A(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(s.DialogTitle,{children:e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s.Typography,{variant:"h6",children:"Import AI Systems from JIRA"}),e.jsx(s.IconButton,{onClick:()=>A(!1),children:e.jsx(we,{size:20})})]})}),e.jsx(s.DialogContent,{dividers:!0,children:Z?e.jsxs(s.Box,{sx:{py:4,textAlign:"center"},children:[e.jsx(s.CircularProgress,{}),e.jsx(s.Typography,{sx:{mt:2},children:"Loading objects from JIRA..."})]}):I.length===0?e.jsx(s.Alert,{severity:"info",children:"No new objects to import. All JIRA objects have already been imported."}):e.jsxs(e.Fragment,{children:[e.jsxs(s.Box,{sx:{mb:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s.FormControlLabel,{control:e.jsx(s.Checkbox,{checked:E.size===I.length&&I.length>0,indeterminate:E.size>0&&E.size<I.length,onChange:se,size:"small"}),label:e.jsxs(s.Typography,{variant:"body2",fontSize:13,children:["Select All (",I.length," objects)"]})}),e.jsxs(s.Typography,{variant:"body2",color:"text.secondary",children:[E.size," selected"]})]}),e.jsx(s.TableContainer,{sx:{maxHeight:400},children:e.jsxs(s.Table,{size:"small",stickyHeader:!0,children:[e.jsx(s.TableHead,{children:e.jsxs(s.TableRow,{children:[e.jsx(s.TableCell,{padding:"checkbox"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Key"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Name"}),e.jsx(s.TableCell,{sx:{fontWeight:600,fontSize:"12px"},children:"Updated"})]})}),e.jsx(s.TableBody,{children:I.map(n=>e.jsxs(s.TableRow,{hover:!0,selected:E.has(n.id),onClick:()=>V(n.id),sx:{cursor:"pointer"},children:[e.jsx(s.TableCell,{padding:"checkbox",children:e.jsx(s.Checkbox,{checked:E.has(n.id),size:"small"})}),e.jsx(s.TableCell,{sx:{fontSize:"13px",fontFamily:"monospace"},children:n.key}),e.jsx(s.TableCell,{sx:{fontSize:"13px"},children:n.name}),e.jsx(s.TableCell,{sx:{fontSize:"12px",color:"#667085"},children:W(n.updated)})]},n.id))})]})})]})}),e.jsxs(s.DialogActions,{sx:{p:2},children:[e.jsx(s.Button,{onClick:()=>A(!1),sx:{textTransform:"none"},children:"Cancel"}),e.jsx(s.Button,{variant:"contained",onClick:ce,disabled:S||E.size===0,startIcon:S?e.jsx(s.CircularProgress,{size:16}):e.jsx(Ee,{size:16}),sx:{backgroundColor:"#13715B",textTransform:"none","&:hover":{backgroundColor:"#0f5a47"}},children:S?"Importing...":`Import ${E.size} Objects`})]})]}),e.jsx(s.Drawer,{anchor:"right",open:ee,onClose:()=>q(!1),children:e.jsx(s.Box,{sx:{width:480,p:3},children:k&&(()=>{var P;const n=typeof k.data=="string"?JSON.parse(k.data):k.data,u=(n==null?void 0:n.label)||((P=n==null?void 0:n.attributes)==null?void 0:P.Name)||k.uc_id,z=(n==null?void 0:n.objectKey)||"-";return e.jsxs(e.Fragment,{children:[e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:3},children:[e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"h6",children:u}),e.jsxs(s.Typography,{variant:"body2",color:"text.secondary",sx:{fontFamily:"monospace"},children:[k.uc_id," | ",z]})]}),e.jsx(s.IconButton,{onClick:()=>q(!1),children:e.jsx(we,{size:20})})]}),e.jsxs(s.Stack,{spacing:2,children:[e.jsx(s.Box,{sx:{display:"flex",gap:1},children:Y(k.sync_status)}),e.jsx(s.Divider,{}),e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{mb:1},children:"Sync Information"}),e.jsxs(s.Stack,{spacing:1,children:[e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(s.Typography,{variant:"body2",color:"text.secondary",children:"Last Synced"}),e.jsx(s.Typography,{variant:"body2",children:W(k.last_synced_at)})]}),e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(s.Typography,{variant:"body2",color:"text.secondary",children:"JIRA Created"}),e.jsx(s.Typography,{variant:"body2",children:W(n==null?void 0:n.created)})]}),e.jsxs(s.Box,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(s.Typography,{variant:"body2",color:"text.secondary",children:"JIRA Updated"}),e.jsx(s.Typography,{variant:"body2",children:W(n==null?void 0:n.updated)})]})]})]}),e.jsx(s.Divider,{}),e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"subtitle2",fontWeight:600,sx:{mb:1},children:"JIRA Attributes"}),e.jsx(s.Stack,{spacing:1,children:Object.entries((n==null?void 0:n.attributes)||{}).map(([L,N])=>e.jsxs(s.Box,{children:[e.jsx(s.Typography,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:L}),e.jsx(s.Typography,{variant:"body2",sx:{wordBreak:"break-word"},children:Array.isArray(N)?N.join(", "):String(N??"N/A")})]},L))})]}),e.jsx(s.Divider,{}),e.jsx(s.Box,{sx:{display:"flex",gap:2},children:e.jsx(s.Button,{variant:"outlined",color:"error",fullWidth:!0,onClick:()=>oe(k),startIcon:e.jsx(Ce,{size:16}),sx:{textTransform:"none"},children:"Delete"})})]})]})})()})})]})},_e=o=>{if(!o)return"-";try{return new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return o}},Ke=o=>{if(o==null)return"-";if(typeof o=="boolean")return o?"Yes":"No";if(Array.isArray(o))return o.join(", ")||"-";if(typeof o=="object")return JSON.stringify(o);const a=String(o);return a.length>50?a.substring(0,47)+"...":a||"-"},Te={border:"1px solid #d0d5dd",borderRadius:2,background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",minWidth:228,width:"100%",padding:"8px 36px 14px 14px",position:"relative"},qe={fontSize:13,color:"#8594AC",pb:"2px",textWrap:"wrap"},Ge={fontSize:16,fontWeight:600,color:"#2D3748"},ge={display:"flex",flexDirection:"row",gap:10,mb:10},fe={display:"flex",flexDirection:"column",gap:10,width:"100%"},re={color:"#1A1919",fontWeight:600,mb:"10px",fontSize:16},Xe={display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",minWidth:"300px",maxWidth:"100%",gap:"40px",backgroundColor:"white",padding:"10px 25px",border:"1px solid #d0d5dd",borderRadius:"4px",boxShadow:"none"},Ye={color:"#2D3748",fontSize:26},Ze=o=>o<=10||o<=20?"#FF4500":o<=30?"#FFA500":o<=40?"#FFD700":o<=50?"#E9F14F":o<=60?"#CDDD24":o<=70?"#64E730":o<=80?"#32CD32":o<=90?"#228B22":"#008000";function R({title:o,body:a,icon:c}){return e.jsxs(s.Stack,{sx:Te,children:[c&&e.jsx(s.Box,{sx:{position:"absolute",top:8,right:8,color:"#8594AC",opacity:.7},children:c}),e.jsx(s.Typography,{sx:qe,children:o}),e.jsx(s.Typography,{sx:Ge,children:a})]})}function Qe({progress:o}){const[a,c]=o.split("/").map(Number),h=c===0?0:Math.floor(a/c*100);return e.jsx(s.Box,{sx:{width:"100%",height:8,backgroundColor:"#E5E7EB",borderRadius:"4px",position:"relative",overflow:"hidden"},children:e.jsx(s.Box,{sx:{width:`${h}%`,height:"100%",backgroundColor:Ze(h),borderRadius:"4px",transition:"width 0.3s ease"}})})}function xe({title:o,completed:a,total:c}){const h=l.useMemo(()=>o.map((i,T)=>{const y=a[T]||0,C=c[T]||0,x=C===0?0:Math.floor(y/C*100);return{label:i,completed:y,total:C,progress:`${y}/${C}`,percentage:x}}),[o,a,c]);return e.jsxs(s.Stack,{sx:Xe,children:[e.jsx(s.Stack,{sx:{width:"100%",display:"flex",justifyContent:"space-between",gap:8,mt:"10px"},children:h.map(i=>e.jsxs(s.Stack,{sx:{gap:1},children:[e.jsx(Qe,{progress:i.progress}),e.jsx(s.Typography,{sx:{color:"#8594AC",fontSize:13},children:`${i.completed} ${i.label} out of ${i.total} is completed`})]},i.label))}),e.jsx(s.Stack,{sx:{display:"flex",flexDirection:"column",gap:"8px"},children:h.map(i=>e.jsx(s.Typography,{sx:Ye,children:`${i.percentage}%`},i.label))})]})}const me=({project:o,apiServices:a})=>{var X;const[c,h]=l.useState(null),[i,T]=l.useState("synced"),[y,C]=l.useState(!0),[x,w]=l.useState(null),[r,D]=l.useState(null),[g,b]=l.useState(null),[f,A]=l.useState([]),I=l.useMemo(()=>{var F;const S=(F=o==null?void 0:o.framework)==null?void 0:F.find(k=>k.framework_id===1);return S==null?void 0:S.project_framework_id},[o==null?void 0:o.framework]),U=l.useMemo(()=>{var F;const S=(F=o==null?void 0:o.framework)==null?void 0:F.find(k=>k.framework_id===2);return S==null?void 0:S.project_framework_id},[o==null?void 0:o.framework]);if(l.useEffect(()=>{if(!(o!=null&&o.id)){C(!1);return}(async()=>{var F;try{if(C(!0),a){const k=await a.get(`/plugins/jira-assets/use-cases/${o.id}`),$=((F=k.data)==null?void 0:F.data)||k.data;h($._jira_data||null),T($._sync_status||"synced")}else{const k=await fetch(`/api/plugins/jira-assets/use-cases/${o.id}`);if(!k.ok)throw new Error("Failed to fetch JIRA data");const $=await k.json();h($._jira_data||null),T($._sync_status||"synced")}w(null)}catch(k){w(k.message)}finally{C(!1)}})()},[o==null?void 0:o.id,a]),l.useEffect(()=>{if(!(o!=null&&o.id)||!a)return;(async()=>{var F,k,$,ee,q;try{if(I)try{const[M,O]=await Promise.all([a.get(`/eu-ai-act/compliances/progress/${I}`),a.get(`/eu-ai-act/assessments/progress/${I}`)]),_=((F=M.data)==null?void 0:F.data)||M.data,j=((k=O.data)==null?void 0:k.data)||O.data;D({subcontrols:{done:(_==null?void 0:_.allDonesubControls)||0,total:(_==null?void 0:_.allsubControls)||0},assessments:{done:(j==null?void 0:j.answeredQuestions)||0,total:(j==null?void 0:j.totalQuestions)||0}})}catch{D(null)}if(U)try{const[M,O]=await Promise.all([a.get(`/iso-42001/clauses/progress/${U}`),a.get(`/iso-42001/annexes/progress/${U}`)]),_=(($=M.data)==null?void 0:$.data)||M.data,j=((ee=O.data)==null?void 0:ee.data)||O.data;b({clauses:{done:(_==null?void 0:_.doneSubclauses)||0,total:(_==null?void 0:_.totalSubclauses)||0},annexes:{done:(j==null?void 0:j.doneAnnexcategories)||0,total:(j==null?void 0:j.totalAnnexcategories)||0}})}catch{b(null)}try{const M=await a.get(`/plugins/jira-assets/projects/${o.id}/custom-frameworks-progress`),O=((q=M.data)==null?void 0:q.data)||M.data||[],_=(Array.isArray(O)?O:[]).map(j=>({name:j.name,progress:{done:j.completed||0,total:j.total||0}}));A(_)}catch{A([])}}catch(M){console.error("Error fetching framework progress:",M)}})()},[o==null?void 0:o.id,I,U,a]),!o)return e.jsx(s.Typography,{children:"No use case found"});if(y)return e.jsx(s.Box,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(s.CircularProgress,{size:24})});if(x)return e.jsxs(s.Typography,{color:"error",children:["Error loading JIRA data: ",x]});const E=(c==null?void 0:c.attributes)||{},H=Object.entries(E).slice(0,5),Z=r||g||f.length>0;return e.jsx(s.Stack,{sx:{width:"100%"},children:e.jsxs(s.Stack,{className:"vw-project-overview",sx:{width:"100%"},children:[e.jsx(s.Box,{sx:{mb:10},children:e.jsx(s.Chip,{icon:e.jsx(ke,{size:14}),label:"Imported from JIRA Assets",size:"small",sx:{backgroundColor:"#E3F2FD",color:"#1565C0","& .MuiChip-icon":{color:"#1565C0"}}})}),e.jsxs(s.Stack,{className:"vw-project-overview-row",sx:ge,children:[e.jsx(R,{title:"JIRA Object Key",body:(c==null?void 0:c.objectKey)||"-",icon:e.jsx(We,{size:16})}),e.jsx(R,{title:"Use case status",body:o.status||"Not started",icon:e.jsx(Be,{size:16})}),e.jsx(R,{title:"Sync Status",body:i.charAt(0).toUpperCase()+i.slice(1),icon:e.jsx(ye,{size:16})})]}),e.jsxs(s.Stack,{className:"vw-project-overview-row",sx:ge,children:[e.jsx(R,{title:"Created in JIRA",body:_e(c==null?void 0:c.created),icon:e.jsx(Me,{size:16})}),e.jsx(R,{title:"Last Updated in JIRA",body:_e(c==null?void 0:c.updated),icon:e.jsx(ue,{size:16})}),e.jsx(R,{title:"Object Type",body:((X=c==null?void 0:c.objectType)==null?void 0:X.name)||"-",icon:e.jsx(je,{size:16})})]}),H.length>0&&e.jsxs(s.Stack,{sx:{mb:10},children:[e.jsx(s.Typography,{sx:re,children:"Key Attributes"}),e.jsx(s.Stack,{className:"vw-project-overview-row",sx:ge,children:H.map(([S,F])=>e.jsx(R,{title:S,body:Ke(F)},S))})]}),e.jsxs(s.Stack,{className:"vw-project-overview-frameworks",sx:{width:"100%",gap:10,mb:10},children:[r&&e.jsxs(s.Stack,{sx:fe,children:[e.jsx(s.Typography,{sx:re,children:"EU AI Act Completion Status"}),e.jsx(xe,{title:["Subcontrols","Assessments"],completed:[r.subcontrols.done,r.assessments.done],total:[r.subcontrols.total,r.assessments.total]})]}),g&&e.jsxs(s.Stack,{sx:fe,children:[e.jsx(s.Typography,{sx:re,children:"ISO 42001 Completion Status"}),e.jsx(xe,{title:["Clauses","Annexes"],completed:[g.clauses.done,g.annexes.done],total:[g.clauses.total,g.annexes.total]})]}),f.map(S=>e.jsxs(s.Stack,{sx:fe,children:[e.jsxs(s.Typography,{sx:re,children:[S.name," Completion Status"]}),e.jsx(xe,{title:["Progress"],completed:[S.progress.done],total:[S.progress.total]})]},S.name))]}),e.jsx(s.Divider,{}),!Z&&e.jsxs(s.Stack,{sx:{gap:10,mt:10},children:[e.jsx(s.Typography,{sx:re,children:"Framework Completion Status"}),e.jsx(s.Box,{sx:{...Te,minHeight:80,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(s.Typography,{sx:{fontSize:13,color:"#8594AC",textAlign:"center"},children:["No frameworks assigned to this use case yet.",e.jsx("br",{}),"Assign frameworks in the Frameworks/regulations tab."]})})]})]})})},Re=({project:o})=>e.jsx(s.Box,{sx:{p:4},children:e.jsxs(s.Stack,{alignItems:"center",spacing:3,children:[e.jsx(s.Box,{sx:{width:80,height:80,borderRadius:"50%",backgroundColor:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Oe,{size:40,color:"#9ca3af"})}),e.jsxs(s.Box,{sx:{textAlign:"center"},children:[e.jsx(s.Typography,{sx:{fontSize:18,fontWeight:600,color:"#374151",mb:1},children:"Post-Market Monitoring"}),e.jsx(s.Typography,{sx:{fontSize:14,color:"#6b7280",maxWidth:450},children:"Post-market monitoring is managed through your JIRA workflow. This use case was imported from JIRA Assets and monitoring data should be tracked in your JIRA instance."})]}),e.jsxs(s.Box,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,backgroundColor:"#EFF6FF",border:"1px solid #BFDBFE",borderRadius:2,p:2,maxWidth:450},children:[e.jsx(Le,{size:18,color:"#3B82F6",style:{flexShrink:0,marginTop:2}}),e.jsx(s.Typography,{sx:{fontSize:13,color:"#1E40AF"},children:"To configure post-market monitoring for this AI system, update the monitoring attributes in JIRA Assets. Changes will sync automatically."})]})]})}),es=o=>o==null?"-":typeof o=="boolean"?o?"Yes":"No":Array.isArray(o)?o.join(", ")||"-":typeof o=="object"?JSON.stringify(o):String(o)||"-",ss=()=>{var h,i,T,y;const o=s.useTheme(),a=((h=o.palette.border)==null?void 0:h.light)||"#E5E7EB",c=((i=o.palette.border)==null?void 0:i.dark)||"#D0D5DD";return{root:{display:"flex",flexDirection:"column",gap:o.spacing(4),fontSize:13,width:"100%",margin:"0 auto"},card:{background:o.palette.background.paper,border:`1.5px solid ${a}`,borderRadius:o.shape.borderRadius,padding:o.spacing(5,6),marginBottom:o.spacing(4),boxShadow:"none",width:"100%"},sectionTitle:{fontWeight:600,fontSize:16,marginBottom:o.spacing(10),color:o.palette.text.primary},gridContainer:{display:"grid",gridTemplateColumns:"220px 1fr",rowGap:"25px",columnGap:"250px",alignItems:"start",mt:2},labelCell:{fontSize:13,fontWeight:500,color:o.palette.text.primary},valueBox:{width:400,padding:"10px 14px",backgroundColor:((T=o.palette.background)==null?void 0:T.fill)||"#F9FAFB",border:`1px solid ${c}`,borderRadius:o.shape.borderRadius,fontSize:13,color:o.palette.text.secondary,wordBreak:"break-word",minHeight:"40px",display:"flex",alignItems:"center"},valueBoxMultiline:{width:400,padding:"10px 14px",backgroundColor:((y=o.palette.background)==null?void 0:y.fill)||"#F9FAFB",border:`1px solid ${c}`,borderRadius:o.shape.borderRadius,fontSize:13,color:o.palette.text.secondary,wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:1.5}}},os=({project:o,apiServices:a})=>{const c=ss(),[h,i]=l.useState(null),[T,y]=l.useState(!0),[C,x]=l.useState(null);if(l.useEffect(()=>{if(!(o!=null&&o.id)){y(!1);return}(async()=>{var b;try{if(y(!0),a){const f=await a.get(`/plugins/jira-assets/use-cases/${o.id}`),A=((b=f.data)==null?void 0:b.data)||f.data;i((A==null?void 0:A._jira_data)||null)}else{const f=await fetch(`/api/plugins/jira-assets/use-cases/${o.id}`);if(!f.ok)throw new Error("Failed to fetch JIRA data");const A=await f.json();i((A==null?void 0:A._jira_data)||null)}x(null)}catch(f){x(f.message)}finally{y(!1)}})()},[o==null?void 0:o.id,a]),!o)return e.jsx(s.Typography,{children:"No use case found"});if(T)return e.jsx(s.Box,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(s.CircularProgress,{size:24})});if(C)return e.jsxs(s.Typography,{color:"error",children:["Error loading JIRA data: ",C]});const w=(h==null?void 0:h.attributes)||{},r=Object.entries(w).map(([g,b])=>({key:g,value:b})),D=(g,b)=>{const f=es(b),A=f.length>80;return e.jsxs(l.Fragment,{children:[e.jsx(s.Box,{children:e.jsx(s.Typography,{sx:c.labelCell,children:g})}),e.jsx(s.Box,{sx:A?c.valueBoxMultiline:c.valueBox,children:f})]},g)};return e.jsxs(s.Stack,{sx:c.root,children:[e.jsxs(s.Box,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(s.Chip,{icon:e.jsx(ke,{size:14}),label:"JIRA Assets Object",size:"small",sx:{backgroundColor:"#E3F2FD",color:"#1565C0","& .MuiChip-icon":{color:"#1565C0"}}}),e.jsx(s.Typography,{sx:{fontSize:13,color:"#6B7280"},children:"This use case is imported from JIRA and is read-only"})]}),e.jsxs(s.Box,{sx:c.card,children:[e.jsxs(s.Typography,{sx:c.sectionTitle,children:["JIRA Attributes (",r.length,")"]}),r.length>0?e.jsx(s.Box,{sx:c.gridContainer,children:r.map(({key:g,value:b})=>D(g,b))}):e.jsx(s.Typography,{sx:{color:"#6B7280",fontStyle:"italic"},children:"No attributes available"})]})]})};return m.JiraAssetsConfiguration=He,m.JiraAssetsUseCasesTab=Ve,m.JiraUseCaseMonitoring=Re,m.JiraUseCaseOverview=me,m.JiraUseCaseSettings=os,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),m}({},jsxRuntime,React,MUI);
//# sourceMappingURL=index.esm.js.map
